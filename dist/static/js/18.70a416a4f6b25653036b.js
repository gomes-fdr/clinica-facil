webpackJsonp([18],{OH9W:function(a,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=e("SirY"),s=e("zlwR"),o=e("VU/8"),r=o(i.a,s.a,!1,null,null,null);t.default=r.exports},SirY:function(a,t,e){"use strict";var i=e("Dd8w"),s=e.n(i),o=e("NHnr"),r=e("IXCS"),d=e.n(r),n=e("PJh5"),l=d.a.Validator.create({templates:{required:"Campo obrigatório"}});t.a={name:"Convenios",beforeCreate:function(){console.log("Carregando infos...")},data:function(){return{modal:{data:[],columns:[{field:"descricao",label:"Descrição"}],isLoading:!1,selected:null,isImageModalActive:!1,isAddPSActive:!0},form:{ps:{id:"",descricao:""},no_carteira:"",dt_validade:"",paciente_id:"",nome:""},table:{data:[],columns:[{field:"ps",label:"Plano de Saúde"},{field:"no_carteira",label:"Numero da Carteira"},{field:"dt_validade",label:"Data de Validade"}],checkedRows:[]}}},validators:{"form.ps.descricao":function(a){return l.value(a).required()},"form.no_carteira":function(a){return l.value(a).required()},"form.dt_validade":function(a){return l.value(a).required()}},mounted:function(){var a=this;o.eBus.$on("PACIENTE_ID",function(t){t&&(a.form.paciente_id=t.id,a.form.nome=t.nome,a.getPSPaciente(t.id))})},methods:{getPSPaciente:function(a){var t=this;console.log("Busca planos de saude de um paciente"),this.form.paciente_id&&this.$http.get("https://sistema-darmas.com.br/api/v1/ps-paciente/"+a).then(function(a){var e=a.data,i={},s=[];for(i in e)s.push({ps:e[i].ps.descricao,dt_validade:n.utc(e[i].dt_validade).format("DD/MM/YYYY"),no_carteira:e[i].no_carteira,id:e[i].id});t.table.data=s}).catch(function(a){})},pesquisarPlano:function(){var a=this;console.log("Consulta planos de saude"),this.modal.isImageModalActive=!0,this.modal.isAddPSActive=!1,this.$http.get("https://sistema-darmas.com.br/api/v1/ps").then(function(t){a.modal.data=t.data}).catch(function(a){console.log(a)})},copiaPS:function(){console.log("Copia planos de saude"),this.modal.isImageModalActive=!1,this.modal.isAddPSActive=!0,this.form.ps=this.modal.selected},addPS:function(){var a=this;this.modal.isAddPSActive=!0,this.form.ps.descricao&&(console.log("Adiciona plano de saude novo"),this.$http.post("https://sistema-darmas.com.br/api/v1/ps/"+this.form.ps.descricao).then(function(t){a.reset()}).catch(function(a){console.log(a)}))},gravaPSPaciente:function(){var a=this;console.log("Grava PS para paciente");var t=s()({},this.form),e=n.utc(t.dt_validade,"DD/MM/YYYY");t.dt_validade=e,this.$validate().then(function(e){e&&a.$http.post("https://sistema-darmas.com.br/api/v1/ps-paciente",t).then(function(t){a.reset(),a.getPSPaciente(a.form.paciente_id)}).catch(function(a){console.log(a)})}).catch(function(a){console.log(a)})},reset:function(){this.form.ps.descricao=null,this.form.ps.id=null,this.form.dt_validade=null,this.form.no_carteira=null,this.validation.reset()},deletePS:function(){var a=this;console.log("Apagar PS paciente");var t={};for(t in this.table.checkedRows)this.$http.get("https://sistema-darmas.com.br/api/v1/ps-paciente/delete/"+this.table.checkedRows[t].id).then(function(a){}).catch(function(t){a.$toast.open({message:"NÃO pode ser removido, em uso.",type:"is-danger",position:"is-bottom"})});this.getPSPaciente(this.form.paciente_id)}}}},zlwR:function(a,t,e){"use strict";var i=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",[e("h4",{staticClass:"title is-4 has-text-black has-text-centered"},[a._v(a._s(a.form.nome))]),a._v(" "),e("form",[e("div",{staticClass:"field is-horizontal"},[a._m(0),a._v(" "),e("div",{staticClass:"field-body"},[e("div",{staticClass:"field"},[e("div",{staticClass:"field has-addons"},[e("p",{staticClass:"control is-expanded"},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.form.ps.descricao,expression:"form.ps.descricao"}],staticClass:"input",class:{"is-danger":a.validation.hasError("form.ps.descricao")},attrs:{type:"text",placeholder:"Plano de Saude",readonly:a.modal.isAddPSActive},domProps:{value:a.form.ps.descricao},on:{input:function(t){t.target.composing||a.$set(a.form.ps,"descricao",t.target.value)}}})]),a._v(" "),e("div",{staticClass:"control"},[e("a",{staticClass:"button",attrs:{disabled:a.modal.isAddPSActive},on:{click:function(t){return t.preventDefault(),a.addPS(t)}}},[e("i",{staticClass:"fas fa-plus"})])]),a._v(" "),e("div",{staticClass:"control"},[e("a",{staticClass:"button"},[e("i",{staticClass:"fas fa-question",on:{click:function(t){return t.preventDefault(),a.pesquisarPlano(t)}}})])])]),a._v(" "),e("p",{directives:[{name:"show",rawName:"v-show",value:a.validation.hasError("form.ps.descricao"),expression:"validation.hasError('form.ps.descricao')"}],staticClass:"help is-danger"},[a._v(a._s(a.validation.firstError("form.ps.descricao")))])]),a._v(" "),e("div",{staticClass:"field"},[e("p",{staticClass:"control is-expanded"},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.form.no_carteira,expression:"form.no_carteira"}],staticClass:"input",class:{"is-danger":a.validation.hasError("form.no_carteira")},attrs:{type:"text",placeholder:"Numero Carteira"},domProps:{value:a.form.no_carteira},on:{input:function(t){t.target.composing||a.$set(a.form,"no_carteira",t.target.value)}}})]),a._v(" "),e("p",{directives:[{name:"show",rawName:"v-show",value:a.validation.hasError("form.no_carteira"),expression:"validation.hasError('form.no_carteira')"}],staticClass:"help is-danger"},[a._v(a._s(a.validation.firstError("form.no_carteira")))])]),a._v(" "),e("div",{staticClass:"field"},[e("p",{staticClass:"control is-expanded"},[e("input",{directives:[{name:"mask",rawName:"v-mask",value:"##/##/####",expression:"'##/##/####'"},{name:"model",rawName:"v-model",value:a.form.dt_validade,expression:"form.dt_validade"}],staticClass:"input",class:{"is-danger":a.validation.hasError("form.dt_validade")},attrs:{type:"text",placeholder:"Data Validade"},domProps:{value:a.form.dt_validade},on:{input:function(t){t.target.composing||a.$set(a.form,"dt_validade",t.target.value)}}})]),a._v(" "),e("p",{directives:[{name:"show",rawName:"v-show",value:a.validation.hasError("form.dt_validade"),expression:"validation.hasError('form.dt_validade')"}],staticClass:"help is-danger"},[a._v(a._s(a.validation.firstError("form.dt_validade")))])])])]),a._v(" "),a._m(1),a._v(" "),e("div",{staticClass:"field is-grouped is-grouped-right"},[e("p",{staticClass:"control"},[e("a",{staticClass:"button is-info",on:{click:function(t){return t.preventDefault(),a.gravaPSPaciente(t)}}},[a._v("Adicionar Convênio")])])])]),a._v(" "),e("b-table",{attrs:{data:a.table.data,columns:a.table.columns,"checked-rows":a.table.checkedRows,checkable:""},on:{"update:checkedRows":function(t){return a.$set(a.table,"checkedRows",t)},"update:checked-rows":function(t){return a.$set(a.table,"checkedRows",t)}}}),a._v(" "),e("div",{staticClass:"field is-grouped is-grouped-right"},[e("button",{staticClass:"button field is-danger",attrs:{disabled:!a.table.checkedRows.length},on:{click:function(t){return t.preventDefault(),a.deletePS(t)}}},[e("i",{staticClass:"fas fa-times"}),a._v("\n     Apagar\n    ")])]),a._v(" "),e("b-modal",{attrs:{active:a.modal.isImageModalActive},on:{"update:active":function(t){return a.$set(a.modal,"isImageModalActive",t)}}},[e("b-table",{attrs:{data:a.modal.data,loading:a.modal.isLoading,columns:a.modal.columns,selected:a.modal.selected},on:{"update:selected":function(t){return a.$set(a.modal,"selected",t)},dblclick:a.copiaPS}})],1)],1)},s=[function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"field-label is-normal"},[e("label",{staticClass:"label"},[a._v("Identificação")])])},function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"field is-horizontal"},[e("div",{staticClass:"field-label is-normal"},[e("label",{staticClass:"label"},[a._v("Consultas")])]),a._v(" "),e("div",{staticClass:"field-body"},[e("div",{staticClass:"field"},[e("input",{staticClass:"input",attrs:{placeholder:"Permitidas"}})])]),a._v(" "),e("div",{staticClass:"field-body"},[e("div",{staticClass:"field"},[e("input",{staticClass:"input",attrs:{placeholder:"Realizdas"}})])])])}],o={render:i,staticRenderFns:s};t.a=o}});
//# sourceMappingURL=18.70a416a4f6b25653036b.js.map