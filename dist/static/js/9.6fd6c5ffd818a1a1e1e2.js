webpackJsonp([9,18],{"G8+J":function(a,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=e("KzF8"),o=e("gYTj"),s=e("VU/8"),n=s(i.a,o.a,!1,null,null,null);t.default=n.exports},"H+bC":function(a,t,e){"use strict";var i=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",[e("form",[e("div",{staticClass:"modal-card",staticStyle:{width:"auto"}},[a._m(0),a._v(" "),e("section",{staticClass:"modal-card-body"},[e("p",{staticClass:" has-text-black has-text-centered"},[a._v("Profissional: "+a._s(a.event.name))]),a._v(" "),e("p",{staticClass:" has-text-black has-text-centered"},[a._v(a._s(a.date))]),a._v(" "),e("br"),a._v(" "),e("form",[e("div",{staticClass:"field is-horizontal"},[a._m(1),a._v(" "),e("div",{staticClass:"field-body"},[e("div",{staticClass:"field"},[e("div",{staticClass:"field has-addons"},[e("p",{staticClass:"control is-expanded"},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.form.paciente.nome,expression:"form.paciente.nome"}],staticClass:"input",class:{"is-danger":a.validation.hasError("form.paciente.nome")},attrs:{type:"text",placeholder:"Nome"},domProps:{value:a.form.paciente.nome},on:{input:function(t){t.target.composing||a.$set(a.form.paciente,"nome",t.target.value)}}})]),a._v(" "),e("div",{staticClass:"control"},[e("a",{staticClass:"button is-right",on:{click:function(t){return t.preventDefault(),a.pesquisaPaciente(t)}}},[e("i",{staticClass:"fas fa-search"})])])]),a._v(" "),e("p",{directives:[{name:"show",rawName:"v-show",value:a.validation.hasError("form.paciente.nome"),expression:"validation.hasError('form.paciente.nome')"}],staticClass:"help is-danger"},[a._v(a._s(a.validation.firstError("form.paciente.nome")))])]),a._v(" "),e("div",{staticClass:"field"},[e("b-select",{attrs:{placeholder:"Convênio",expanded:""},model:{value:a.form.convenio,callback:function(t){a.$set(a.form,"convenio",t)},expression:"form.convenio"}},a._l(a.apiConvenios,function(t){return e("option",{key:t.id,domProps:{value:t}},[a._v("\n                "+a._s(t.descricao)+"\n                ")])}),0),a._v(" "),e("p",{directives:[{name:"show",rawName:"v-show",value:a.validation.hasError("form.convenio"),expression:"validation.hasError('form.convenio')"}],staticClass:"help is-danger"},[a._v(a._s(a.validation.firstError("form.convenio")))])],1)])])])]),a._v(" "),e("footer",{staticClass:"modal-card-foot"},[e("div",{staticClass:"field is-grouped is-grouped-right"},[e("button",{staticClass:"button is-danger",attrs:{disabled:!0}},[a._v("Confirmar Ausência")]),a._v(" "),e("button",{staticClass:"button is-danger",attrs:{disabled:!0}},[a._v("Apagar Consulta")]),a._v(" "),e("button",{staticClass:"button is-info",attrs:{disabled:!0}},[a._v("Confirmar Presença")]),a._v(" "),e("button",{staticClass:"button is-info",on:{click:function(t){return t.preventDefault(),a.salvarConsulta(t)}}},[a._v("Salvar Consulta")])])])])]),a._v(" "),e("b-modal",{attrs:{active:a.modal.isActive},on:{"update:active":function(t){return a.$set(a.modal,"isActive",t)}}},[e("b-table",{attrs:{data:a.modal.data,loading:a.modal.isLoading,columns:a.modal.columns,selected:a.modal.selected},on:{"update:selected":function(t){return a.$set(a.modal,"selected",t)},dblclick:a.copiaPaciente}})],1)],1)},o=[function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("header",{staticClass:"modal-card-head"},[e("p",{staticClass:"modal-card-title"},[a._v("Controle de Consulta")])])},function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"field-label is-normal"},[e("label",{staticClass:"label"},[a._v("Paciente")])])}],s={render:i,staticRenderFns:o};t.a=s},KzF8:function(a,t,e){"use strict";var i=e("IXCS"),o=e.n(i),s=e("mtWM"),n=e.n(s),r=e("U91L"),l=o.a.Validator.create({templates:{required:"Campo obrigatório"}}),c=n.a.create({baseURL:"https://sistema-darmas.com.br/api/v1/",headers:{Authorization:"Bearer: "+localStorage.getItem("token")}}),d=e("PJh5");t.a={name:"Consulta",components:{ControleConsulta:r.default},data:function(){return{apiEspecialidade:[],modal:{calendario:{isActive:!1},agenda:{isActive:!1}},formControl:{radio:"Especialidade",isProfissionalDisabled:!1},formData:{dt_inicio:"",dt_fim:"",nomeProfissional:"",nomePaciente:""},events:[],event:{date:null,startTime:"",endTime:"",name:null,horario_id:null,profissional_id:null}}},validators:{"formData.dt_inicio":function(a){return l.value(a).required()},"formData.dt_fim":function(a){return l.value(a).required()},"formData.nomeProfissional":function(a){if("Profissional"===this.formControl.radio)return l.value(a).required()},"formData.nomePaciente":function(a){if("Paciente"===this.formControl.radio)return l.value(a).required()}},methods:{initApp:function(){var a=new Date,t=d.utc(a,"DD/MM/YYYY").add(1,"days");this.formData.dt_inicio=d.utc(a).format("DD/MM/YYYY"),this.formData.dt_fim=d.utc(t).format("DD/MM/YYYY");var e=localStorage.getItem("nome");switch(localStorage.getItem("perfil")){case"Psicologo":case"Psiquiatra":case"Nutricionista":case"Fonoaudiologo":case"Neurologista":this.formControl.radio="Profissional",this.formControl.isProfissionalDisabled=!0,this.formData.nomeProfissional=e}},showCalendar:function(){var a=this;a.events=[],this.$validate().then(function(t){t&&(console.log("Calendario de eventos"),c.get("https://sistema-darmas.com.br/api/v1/agenda/horario/profissional?dt_inicio="+a.formData.dt_inicio+"&dt_fim="+a.formData.dt_fim+"&livre=true",{}).then(function(t){t.data.forEach(function(t){var e={date:null,startTime:"",endTime:"",name:null,horario_id:null,profissional_id:null};e.date=t.dt_dia,e.startTime=t.hora_ini,e.endTime=t.hora_fim,e.name=t.profissional.nome,e.profissional_id=t.profissional.id,e.horario_id=t.id,a.events.push(e)}),a.modal.calendario.isActive=!0}).catch(function(t){console.log(t.response.status),404===t.response.status&&a.$toast.open({message:"NENHUM HORARIO encontrado",type:"is-danger",position:"is-bottom"})}))}).catch(function(a){console.log(a)})},eventClicked:function(a){this.event=a,this.modal.agenda.isActive=!0},carregaEspecialidades:function(){var a=this;console.log("Carregando as especialidades..."),c.get("https://sistema-darmas.com.br/api/v1/agenda/especialidades").then(function(t){a.apiEspecialidade=t.data}).catch(function(a){})},enviaSMS:function(){console.log("Envia SMS");var a={sendSmsRequest:{from:"Fargos Sistemas",to:"5551995489581",schedule:"2019-05-08T11:43:00",msg:"Sistema darmas sabe mandar SMS",callbackOption:"NONE",id:"004",aggregateId:"49548",flashSms:!1}};n.a.create({baseURL:"https://api-rest.zenvia.com/services",auth:{username:"fdrgomes.smsonline",password:"O6m9MzWkQG"},headers:{"Content-Type":"application/json",Accept:"application/json",CrossDomain:!0}}).post("/send-sms",a).then(function(a){console.log(a.data)}).catch(function(a){})}},mounted:function(){this.initApp()},created:function(){this.carregaEspecialidades()},computed:{dataInicial:function(){return d.utc(this.formData.dt_inicio,"DD/MM/YYYY")}}}},U91L:function(a,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=e("X6Eo"),o=e("H+bC"),s=e("VU/8"),n=s(i.a,o.a,!1,null,null,null);t.default=n.exports},X6Eo:function(a,t,e){"use strict";var i=e("mtWM"),o=e.n(i),s=e("IXCS"),n=e.n(s),r=e("PJh5"),l=o.a.create({baseURL:"https://sistema-darmas.com.br/api/v1/",headers:{Authorization:"Bearer: "+localStorage.getItem("token")}}),c=n.a.Validator.create({templates:{required:"Campo obrigatório"}});t.a={name:"ControleConsulta",props:["event"],data:function(){return{date:"",apiConvenios:[],form:{dataMarcacao:null,confirmacao_consulta_sms:!1,compareceu:!1,paciente:{id:"",nome:""},quem_marcou_id:"",horario_id:"",convenio:[]},modal:{isLoading:!1,isActive:!1,data:[],columns:[{field:"nome",label:"Nome"},{field:"cpf",label:"CPF"}],selected:null}}},validators:{"form.paciente.nome":function(a){return c.value(a).required()},"form.convenio":function(a){return c.value(a).required()}},mounted:function(){this.initApp()},methods:{initApp:function(){this.date=r.utc(this.event.date).format("dddd, DD MMMM YYYY")+" das "+this.event.startTime+" as "+this.event.endTime,this.form.horario_id=this.event.horario_id,this.form.quem_marcou_id=localStorage.getItem("profissional_id")},salvarConsulta:function(){var a=this;console.log("Salvar NOVA consulta");var t=this;this.$validate().then(function(e){if(e){var i=a.form;i.dataMarcacao=new Date,l.post("https://sistema-darmas.com.br/api/v1/agenda/consulta",i).then(function(a){a&&(t.$toast.open({message:"CONSULTA salav com sucesso",type:"is-success",position:"is-bottom"}),t.$parent.close())}).catch(function(a){t.$toast.open({message:"FALHA ao gravar uma CONSULTA",type:"is-danger",position:"is-bottom"})}).finally(function(){})}}).catch(function(a){})},pesquisaPaciente:function(){if(console.log("Pesquisa paciente"),this.form.paciente.nome.length){var a=this;l.get("https://sistema-darmas.com.br/api/v1/paciente/nome/"+a.form.paciente.nome,{}).then(function(t){t&&(a.modal.data=t.data,a.modal.isActive=!0)}).catch(function(t){a.$toast.open({message:"NENHUM PACIENTE encontrado.",type:"is-danger",position:"is-bottom"})}).finally(function(){a.modal.isLoading=!1})}},copiaPaciente:function(){console.log("Copia paciente");var a=this;l.get("https://sistema-darmas.com.br/api/v1/paciente/nome-completo/"+a.modal.selected.nome).then(function(t){var e=t.data;a.form.paciente.id=e.id,a.form.paciente.nome=e.nome,a.getPSPaciente(a.form.paciente.id)}).catch(function(a){console.log(a)}).finally(function(){a.modal.isLoading=!1}),this.modal.isActive=!1},getPSPaciente:function(a){console.log("Busca planos de saude de um paciente");var t=this;l.get("https://sistema-darmas.com.br/api/v1/ps-paciente/"+a,{}).then(function(a){console.log(a.data),a.data.forEach(function(a){var e={id:"",descricao:""};e.id=a.id,e.descricao=a.ps.descricao,t.apiConvenios.push(e)})}).catch(function(a){console.log(a)})}}}},gYTj:function(a,t,e){"use strict";var i=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",[e("form",[e("section",{staticClass:"level"},[e("div",{staticClass:"level-item has-text-centered"},[e("div",{staticClass:"block"},[e("b-radio",{attrs:{"native-value":"Especialidade"},model:{value:a.formControl.radio,callback:function(t){a.$set(a.formControl,"radio",t)},expression:"formControl.radio"}},[a._v("\n                Por Especialidade\n            ")]),a._v(" "),e("b-radio",{attrs:{disabled:a.formControl.isProfissionalDisabled,"native-value":"TodosProfissionais"},model:{value:a.formControl.radio,callback:function(t){a.$set(a.formControl,"radio",t)},expression:"formControl.radio"}},[a._v("\n                Todos os profissionais\n            ")]),a._v(" "),e("b-radio",{attrs:{"native-value":"Profissional"},model:{value:a.formControl.radio,callback:function(t){a.$set(a.formControl,"radio",t)},expression:"formControl.radio"}},[a._v("\n                Profissional\n            ")])],1)])]),a._v(" "),e("div",{staticClass:"field is-horizontal"},[a._m(0),a._v(" "),e("div",{staticClass:"field-body"},[e("div",{staticClass:"field"},[e("p",{staticClass:"control"},[e("input",{directives:[{name:"mask",rawName:"v-mask",value:"##/##/####",expression:"'##/##/####'"},{name:"model",rawName:"v-model",value:a.formData.dt_inicio,expression:"formData.dt_inicio"}],staticClass:"input",class:{"is-danger":a.validation.hasError("formData.dt_inicio")},attrs:{type:"text",placeholder:"Inicio"},domProps:{value:a.formData.dt_inicio},on:{input:function(t){t.target.composing||a.$set(a.formData,"dt_inicio",t.target.value)}}})]),a._v(" "),e("p",{directives:[{name:"show",rawName:"v-show",value:a.validation.hasError("formData.dt_inicio"),expression:"validation.hasError('formData.dt_inicio')"}],staticClass:"help is-danger"},[a._v(a._s(a.validation.firstError("formData.dt_inicio")))])]),a._v(" "),e("div",{staticClass:"field"},[e("p",{staticClass:"control"},[e("input",{directives:[{name:"mask",rawName:"v-mask",value:"##/##/####",expression:"'##/##/####'"},{name:"model",rawName:"v-model",value:a.formData.dt_fim,expression:"formData.dt_fim"}],staticClass:"input",class:{"is-danger":a.validation.hasError("formData.dt_fim")},attrs:{type:"text",placeholder:"Fim"},domProps:{value:a.formData.dt_fim},on:{input:function(t){t.target.composing||a.$set(a.formData,"dt_fim",t.target.value)}}})]),a._v(" "),e("p",{directives:[{name:"show",rawName:"v-show",value:a.validation.hasError("formData.dt_fim"),expression:"validation.hasError('formData.dt_fim')"}],staticClass:"help is-danger"},[a._v(a._s(a.validation.firstError("formData.dt_fim")))])])])]),a._v(" "),e("div",{staticClass:"field is-horizontal"},[e("div",{directives:[{name:"show",rawName:"v-show",value:"Especialidade"==a.formControl.radio||"Profissional"==a.formControl.radio,expression:"(formControl.radio == 'Especialidade') || (formControl.radio == 'Profissional')"}],staticClass:"field-label is-normal"},[e("label",{staticClass:"label"},[a._v("Horários")])]),a._v(" "),e("div",{staticClass:"field-body"},["Paciente"==a.formControl.radio?e("div",{staticClass:"field"},[e("div",{staticClass:"field has-addons"},[e("p",{staticClass:"control is-expanded"},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.formData.nomePaciente,expression:"formData.nomePaciente"}],staticClass:"input",class:{"is-danger":a.validation.hasError("formData.nomePaciente")},attrs:{type:"text",placeholder:"Paciente"},domProps:{value:a.formData.nomePaciente},on:{input:function(t){t.target.composing||a.$set(a.formData,"nomePaciente",t.target.value)}}})]),a._v(" "),a._m(1)]),a._v(" "),e("p",{directives:[{name:"show",rawName:"v-show",value:a.validation.hasError("formData.nomePaciente"),expression:"validation.hasError('formData.nomePaciente')"}],staticClass:"help is-danger"},[a._v(a._s(a.validation.firstError("formData.nomePaciente")))])]):a._e(),a._v(" "),"Especialidade"==a.formControl.radio?e("div",{staticClass:"field"},[e("b-select",{attrs:{placeholder:"Especialidade",expanded:""}},a._l(a.apiEspecialidade,function(t){return e("option",{key:t.id,domProps:{value:t.id}},[a._v("\n              "+a._s(t.descricao)+"\n            ")])}),0)],1):a._e(),a._v(" "),"Profissional"==a.formControl.radio?e("div",{staticClass:"field"},[e("div",{staticClass:"field has-addons"},[e("p",{staticClass:"control is-expanded"},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.formData.nomeProfissional,expression:"formData.nomeProfissional"}],staticClass:"input",class:{"is-danger":a.validation.hasError("formData.nomeProfissional")},attrs:{type:"text",placeholder:"Profissional",readonly:a.formControl.isProfissionalDisabled},domProps:{value:a.formData.nomeProfissional},on:{input:function(t){t.target.composing||a.$set(a.formData,"nomeProfissional",t.target.value)}}})]),a._v(" "),e("div",{staticClass:"control"},[e("a",{staticClass:"button",attrs:{disabled:a.formControl.isProfissionalDisabled}},[e("i",{staticClass:"fas fa-search"})])])]),a._v(" "),e("p",{directives:[{name:"show",rawName:"v-show",value:a.validation.hasError("formData.nomeProfissional"),expression:"validation.hasError('formData.nomeProfissional')"}],staticClass:"help is-danger"},[a._v(a._s(a.validation.firstError("formData.nomeProfissional")))])]):a._e()])]),a._v(" "),e("div",{staticClass:"field is-grouped is-grouped-right"},[e("p",{staticClass:"control"},[e("a",{staticClass:"button is-info",attrs:{disabled:!1}},[a._v("Horários Preenchidos")])]),a._v(" "),e("p",{staticClass:"control"},[e("a",{staticClass:"button is-info",on:{click:function(t){return t.preventDefault(),a.showCalendar(t)}}},[a._v("Horários Vagos")])])])]),a._v(" "),e("b-modal",{attrs:{active:a.modal.calendario.isActive},on:{"update:active":function(t){return a.$set(a.modal.calendario,"isActive",t)}}},[e("vue-scheduler",{attrs:{events:a.events,"event-display":"name","disable-dialog":!0,initialDate:a.dataInicial},on:{"event-clicked":a.eventClicked}})],1),a._v(" "),e("b-modal",{attrs:{active:a.modal.agenda.isActive},on:{"update:active":function(t){return a.$set(a.modal.agenda,"isActive",t)}}},[e("controle-consulta",{attrs:{event:a.event}})],1)],1)},o=[function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"field-label is-normal"},[e("label",{staticClass:"label"},[a._v("Periodo")])])},function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"control"},[e("a",{staticClass:"button"},[e("i",{staticClass:"fas fa-search"})])])}],s={render:i,staticRenderFns:o};t.a=s}});
//# sourceMappingURL=9.6fd6c5ffd818a1a1e1e2.js.map