webpackJsonp([18],{JGtw:function(t,e,a){"use strict";var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("form",[a("div",{staticClass:"modal-card",staticStyle:{width:"auto"}},[t._m(0),t._v(" "),a("section",{staticClass:"modal-card-body"},[a("p",{staticClass:" has-text-black has-text-centered"},[t._v("Profissional: "+t._s(t.event.name))]),t._v(" "),a("p",{staticClass:" has-text-black has-text-centered"},[t._v(t._s(t.date))]),t._v(" "),a("br"),t._v(" "),a("form",[a("div",{staticClass:"field is-horizontal"},[t._m(1),t._v(" "),a("div",{staticClass:"field-body"},[a("div",{staticClass:"field"},[a("div",{staticClass:"field has-addons"},[a("p",{staticClass:"control is-expanded"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.paciente.nome,expression:"form.paciente.nome"}],staticClass:"input",class:{"is-danger":t.validation.hasError("form.paciente.nome")},attrs:{type:"text",placeholder:"Nome"},domProps:{value:t.form.paciente.nome},on:{input:function(e){e.target.composing||t.$set(t.form.paciente,"nome",e.target.value)}}})]),t._v(" "),a("div",{staticClass:"control"},[a("a",{staticClass:"button is-right",on:{click:function(e){return e.preventDefault(),t.pesquisaPaciente(e)}}},[a("i",{staticClass:"fas fa-search"})])])]),t._v(" "),a("p",{directives:[{name:"show",rawName:"v-show",value:t.validation.hasError("form.paciente.nome"),expression:"validation.hasError('form.paciente.nome')"}],staticClass:"help is-danger"},[t._v(t._s(t.validation.firstError("form.paciente.nome")))])]),t._v(" "),a("div",{staticClass:"field"},[a("b-select",{attrs:{placeholder:"Convênio",expanded:""},model:{value:t.form.convenio,callback:function(e){t.$set(t.form,"convenio",e)},expression:"form.convenio"}},t._l(t.apiConvenios,function(e){return a("option",{key:e.id,domProps:{value:e}},[t._v("\n                "+t._s(e.descricao)+"\n                ")])}),0),t._v(" "),a("p",{directives:[{name:"show",rawName:"v-show",value:t.validation.hasError("form.convenio"),expression:"validation.hasError('form.convenio')"}],staticClass:"help is-danger"},[t._v(t._s(t.validation.firstError("form.convenio")))])],1)])])])]),t._v(" "),a("footer",{staticClass:"modal-card-foot"},[a("div",{staticClass:"field is-grouped is-grouped-right"},[a("button",{staticClass:"button is-danger",attrs:{disabled:!0}},[t._v("Confirmar Ausência")]),t._v(" "),a("button",{staticClass:"button is-danger",attrs:{disabled:!0}},[t._v("Apagar Consulta")]),t._v(" "),a("button",{staticClass:"button is-info",attrs:{disabled:!0}},[t._v("Confirmar Presença")]),t._v(" "),a("button",{staticClass:"button is-info",on:{click:function(e){return e.preventDefault(),t.salvarConsulta(e)}}},[t._v("Salvar Consulta")])])])])]),t._v(" "),a("b-modal",{attrs:{active:t.modal.isActive},on:{"update:active":function(e){return t.$set(t.modal,"isActive",e)}}},[a("b-table",{attrs:{data:t.modal.data,loading:t.modal.isLoading,columns:t.modal.columns,selected:t.modal.selected},on:{"update:selected":function(e){return t.$set(t.modal,"selected",e)},dblclick:t.copiaPaciente}})],1)],1)},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("header",{staticClass:"modal-card-head"},[a("p",{staticClass:"modal-card-title"},[t._v("Controle de Consulta")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"field-label is-normal"},[a("label",{staticClass:"label"},[t._v("Paciente")])])}],n={render:o,staticRenderFns:i};e.a=n},U91L:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a("X6Eo"),i=a("JGtw"),n=a("VU/8"),s=n(o.a,i.a,!1,null,null,null);e.default=s.exports},X6Eo:function(t,e,a){"use strict";var o=a("mtWM"),i=a.n(o),n=a("NHnr"),s=a("IXCS"),c=a.n(s),r=a("PJh5"),l=i.a.create({baseURL:n.API_URL,headers:{Authorization:"Bearer: "+localStorage.getItem("token")}}),d=c.a.Validator.create({templates:{required:"Campo obrigatório"}});e.a={name:"ControleConsulta",props:["event"],data:function(){return{date:"",apiConvenios:[],form:{dataMarcacao:null,confirmacao_consulta_sms:!1,compareceu:!1,paciente:{id:"",nome:""},quem_marcou_id:"",horario_id:"",convenio:[]},modal:{isLoading:!1,isActive:!1,data:[],columns:[{field:"nome",label:"Nome"},{field:"cpf",label:"CPF"}],selected:null}}},validators:{"form.paciente.nome":function(t){return d.value(t).required()},"form.convenio":function(t){return d.value(t).required()}},mounted:function(){this.initApp()},methods:{initApp:function(){this.date=r.utc(this.event.date).format("dddd, DD MMMM YYYY")+" das "+this.event.startTime+" as "+this.event.endTime,this.form.horario_id=this.event.horario_id,this.form.quem_marcou_id=localStorage.getItem("profissional_id")},salvarConsulta:function(){var t=this;console.log("Salvar NOVA consulta");var e=this;this.$validate().then(function(a){if(a){var o=t.form;o.dataMarcacao=new Date,l.post(n.API_URL+"agenda/consulta",o).then(function(t){t&&(e.$toast.open({message:"CONSULTA salav com sucesso",type:"is-success",position:"is-bottom"}),e.$parent.close())}).catch(function(t){e.$toast.open({message:"FALHA ao gravar uma CONSULTA",type:"is-danger",position:"is-bottom"})}).finally(function(){})}}).catch(function(t){})},pesquisaPaciente:function(){if(console.log("Pesquisa paciente"),this.form.paciente.nome.length){var t=this;l.get(n.API_URL+"paciente/nome/"+t.form.paciente.nome,{}).then(function(e){e&&(t.modal.data=e.data,t.modal.isActive=!0)}).catch(function(e){t.$toast.open({message:"NENHUM PACIENTE encontrado.",type:"is-danger",position:"is-bottom"})}).finally(function(){t.modal.isLoading=!1})}},copiaPaciente:function(){console.log("Copia paciente");var t=this;l.get(n.API_URL+"paciente/nome-completo/"+t.modal.selected.nome).then(function(e){var a=e.data;t.form.paciente.id=a.id,t.form.paciente.nome=a.nome,t.getPSPaciente(t.form.paciente.id)}).catch(function(t){console.log(t)}).finally(function(){t.modal.isLoading=!1}),this.modal.isActive=!1},getPSPaciente:function(t){console.log("Busca planos de saude de um paciente");var e=this;l.get(n.API_URL+"ps-paciente/"+t,{}).then(function(t){console.log(t.data),t.data.forEach(function(t){var a={id:"",descricao:""};a.id=t.id,a.descricao=t.ps.descricao,e.apiConvenios.push(a)})}).catch(function(t){console.log(t)})}}}}});
//# sourceMappingURL=18.184d888d16b1a5b9b109.js.map