webpackJsonp([17],{OH9W:function(a,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=t("SirY"),s=t("mrVB"),o=t("VU/8"),r=o(i.a,s.a,!1,null,null,null);e.default=r.exports},SirY:function(a,e,t){"use strict";var i=t("Dd8w"),s=t.n(i),o=t("NHnr"),r=t("mtWM"),n=t.n(r),d=t("IXCS"),l=t.n(d),c=t("PJh5"),u=n.a.create({baseURL:o.API_URL,headers:{Authorization:"Bearer: "+localStorage.getItem("token")}}),v=l.a.Validator.create({templates:{required:"Campo obrigatório"}});e.a={name:"Convenios",beforeCreate:function(){console.log("Carregando infos...")},data:function(){return{modal:{data:[],columns:[{field:"descricao",label:"Descrição"}],isLoading:!1,selected:null,isImageModalActive:!1,isAddPSActive:!0},form:{ps:{id:"",descricao:""},no_carteira:"",dt_validade:"",paciente_id:"",nome:""},table:{data:[],columns:[{field:"ps",label:"Plano de Saúde"},{field:"no_carteira",label:"Numero da Carteira"},{field:"dt_validade",label:"Data de Validade"}],checkedRows:[]}}},validators:{"form.ps.descricao":function(a){return v.value(a).required()},"form.no_carteira":function(a){return v.value(a).required()},"form.dt_validade":function(a){return v.value(a).required()}},mounted:function(){var a=this;o.eBus.$on("PACIENTE_ID",function(e){e&&(a.form.paciente_id=e.id,a.form.nome=e.nome,a.getPSPaciente(e.id))})},methods:{getPSPaciente:function(a){if(console.log("Busca planos de saude de um paciente"),this.form.paciente_id){var e=this;u.get(o.API_URL+"ps-paciente/"+a,{}).then(function(a){var t=a.data,i={},s=[];for(i in t)s.push({ps:t[i].ps.descricao,dt_validade:c.utc(t[i].dt_validade).format("DD/MM/YYYY"),no_carteira:t[i].no_carteira,id:t[i].id});e.table.data=s}).catch(function(a){e.table.data=[]})}},pesquisarPlano:function(){console.log("Consulta planos de saude");var a=this;this.modal.isImageModalActive=!0,this.modal.isAddPSActive=!1,u.get(o.API_URL+"ps",{}).then(function(e){a.modal.data=e.data}).catch(function(a){console.log(a)})},copiaPS:function(){console.log("Copia planos de saude"),this.modal.isImageModalActive=!1,this.modal.isAddPSActive=!0,this.form.ps=this.modal.selected},addPS:function(){if(this.modal.isAddPSActive=!0,this.form.ps.descricao){console.log("Adiciona plano de saude novo");var a=this;u.post(o.API_URL+"ps/"+a.form.ps.descricao).then(function(e){a.reset()}).catch(function(a){console.log(a)})}},gravaPSPaciente:function(){console.log("Grava PS para paciente");var a=this,e=s()({},this.form),t=c.utc(e.dt_validade,"DD/MM/YYYY");e.dt_validade=t,this.$validate().then(function(t){t&&u.post(o.API_URL+"ps-paciente",e).then(function(e){a.reset(),a.getPSPaciente(a.form.paciente_id)}).catch(function(a){console.log(a)})}).catch(function(a){console.log(a)})},reset:function(){this.form.ps.descricao=null,this.form.ps.id=null,this.form.dt_validade=null,this.form.no_carteira=null,this.validation.reset()},deletePS:function(){console.log("Apagar PS paciente");var a=this,e={};for(e in this.table.checkedRows)u.get(o.API_URL+"ps-paciente/delete/"+a.table.checkedRows[e].id,{}).then(function(a){}).catch(function(a){console.log(a)});this.getPSPaciente(this.form.paciente_id)}}}},mrVB:function(a,e,t){"use strict";var i=function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("div",[t("h4",{staticClass:"title is-4 has-text-black has-text-centered"},[a._v(a._s(a.form.nome))]),a._v(" "),t("form",[t("div",{staticClass:"field is-horizontal"},[a._m(0),a._v(" "),t("div",{staticClass:"field-body"},[t("div",{staticClass:"field"},[t("div",{staticClass:"field has-addons"},[t("p",{staticClass:"control is-expanded"},[t("input",{directives:[{name:"model",rawName:"v-model",value:a.form.ps.descricao,expression:"form.ps.descricao"}],staticClass:"input",class:{"is-danger":a.validation.hasError("form.ps.descricao")},attrs:{type:"text",placeholder:"Plano de Saude",readonly:a.modal.isAddPSActive},domProps:{value:a.form.ps.descricao},on:{input:function(e){e.target.composing||a.$set(a.form.ps,"descricao",e.target.value)}}})]),a._v(" "),t("div",{staticClass:"control"},[t("a",{staticClass:"button",attrs:{disabled:a.modal.isAddPSActive},on:{click:function(e){return e.preventDefault(),a.addPS(e)}}},[t("i",{staticClass:"fas fa-plus"})])]),a._v(" "),t("div",{staticClass:"control"},[t("a",{staticClass:"button"},[t("i",{staticClass:"fas fa-question",on:{click:function(e){return e.preventDefault(),a.pesquisarPlano(e)}}})])])]),a._v(" "),t("p",{directives:[{name:"show",rawName:"v-show",value:a.validation.hasError("form.ps.descricao"),expression:"validation.hasError('form.ps.descricao')"}],staticClass:"help is-danger"},[a._v(a._s(a.validation.firstError("form.ps.descricao")))])]),a._v(" "),t("div",{staticClass:"field"},[t("p",{staticClass:"control is-expanded"},[t("input",{directives:[{name:"model",rawName:"v-model",value:a.form.no_carteira,expression:"form.no_carteira"}],staticClass:"input",class:{"is-danger":a.validation.hasError("form.no_carteira")},attrs:{type:"text",placeholder:"Numero Carteira"},domProps:{value:a.form.no_carteira},on:{input:function(e){e.target.composing||a.$set(a.form,"no_carteira",e.target.value)}}})]),a._v(" "),t("p",{directives:[{name:"show",rawName:"v-show",value:a.validation.hasError("form.no_carteira"),expression:"validation.hasError('form.no_carteira')"}],staticClass:"help is-danger"},[a._v(a._s(a.validation.firstError("form.no_carteira")))])]),a._v(" "),t("div",{staticClass:"field"},[t("p",{staticClass:"control is-expanded"},[t("input",{directives:[{name:"mask",rawName:"v-mask",value:"##/##/####",expression:"'##/##/####'"},{name:"model",rawName:"v-model",value:a.form.dt_validade,expression:"form.dt_validade"}],staticClass:"input",class:{"is-danger":a.validation.hasError("form.dt_validade")},attrs:{type:"text",placeholder:"Data Validade"},domProps:{value:a.form.dt_validade},on:{input:function(e){e.target.composing||a.$set(a.form,"dt_validade",e.target.value)}}})]),a._v(" "),t("p",{directives:[{name:"show",rawName:"v-show",value:a.validation.hasError("form.dt_validade"),expression:"validation.hasError('form.dt_validade')"}],staticClass:"help is-danger"},[a._v(a._s(a.validation.firstError("form.dt_validade")))])])])]),a._v(" "),t("div",{staticClass:"field is-grouped is-grouped-right"},[t("p",{staticClass:"control"},[t("a",{staticClass:"button is-info",on:{click:function(e){return e.preventDefault(),a.gravaPSPaciente(e)}}},[a._v("Adicionar Convênio")])])])]),a._v(" "),t("b-table",{attrs:{data:a.table.data,columns:a.table.columns,"checked-rows":a.table.checkedRows,checkable:""},on:{"update:checkedRows":function(e){return a.$set(a.table,"checkedRows",e)},"update:checked-rows":function(e){return a.$set(a.table,"checkedRows",e)}}}),a._v(" "),t("div",{staticClass:"field is-grouped is-grouped-right"},[t("button",{staticClass:"button field is-danger",attrs:{disabled:!a.table.checkedRows.length},on:{click:function(e){return e.preventDefault(),a.deletePS(e)}}},[t("i",{staticClass:"fas fa-times"}),a._v("\n     Apagar\n    ")])]),a._v(" "),t("b-modal",{attrs:{active:a.modal.isImageModalActive},on:{"update:active":function(e){return a.$set(a.modal,"isImageModalActive",e)}}},[t("b-table",{attrs:{data:a.modal.data,loading:a.modal.isLoading,columns:a.modal.columns,selected:a.modal.selected},on:{"update:selected":function(e){return a.$set(a.modal,"selected",e)},dblclick:a.copiaPS}})],1)],1)},s=[function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("div",{staticClass:"field-label is-normal"},[t("label",{staticClass:"label"},[a._v("Identificação")])])}],o={render:i,staticRenderFns:s};e.a=o}});
//# sourceMappingURL=17.44a366c4ed820c60f130.js.map